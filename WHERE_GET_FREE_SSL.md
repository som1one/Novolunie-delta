# üîí –ì–¥–µ –≤–∑—è—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

## ‚úÖ –û—Ç–≤–µ—Ç: Let's Encrypt

**–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** = **Let's Encrypt**

–≠—Ç–æ —Å–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π:
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π
- ‚úÖ –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 90 –¥–Ω–µ–π (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è)
- ‚úÖ –ü—Ä–∏–∑–Ω–∞–µ—Ç—Å—è –≤—Å–µ–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏
- ‚úÖ –í—ã–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ certbot

---

## üöÄ –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å (2 —Å–ø–æ—Å–æ–±–∞)

### –°–ø–æ—Å–æ–± 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

–°–∫—Ä–∏–ø—Ç `install-ssl-dns.sh` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Let's Encrypt:

```bash
cd ~/novolunie
git pull origin main
sudo ./install-ssl-dns.sh
```

**–°–∫—Ä–∏–ø—Ç –¥–µ–ª–∞–µ—Ç:**
1. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç certbot (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
2. –ü–æ–ª—É—á–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Let's Encrypt —á–µ—Ä–µ–∑ DNS challenge
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `/etc/letsencrypt/live/e-novolunie.ru/`
4. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç Nginx

---

### –°–ø–æ—Å–æ–± 2: –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ certbot

#### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ certbot:
```bash
sudo apt update
sudo apt install certbot -y
```

#### –ü–æ–ª—É—á–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —á–µ—Ä–µ–∑ DNS challenge:
```bash
sudo certbot certonly --manual --preferred-challenges dns \
  -d e-novolunie.ru -d www.e-novolunie.ru \
  --register-unsafely-without-email --agree-tos
```

**–ò–ª–∏ —Å email:**
```bash
sudo certbot certonly --manual --preferred-challenges dns \
  -d e-novolunie.ru -d www.e-novolunie.ru \
  --email –≤–∞—à@email.com --agree-tos
```

#### Certbot –ø–æ–∫–∞–∂–µ—Ç TXT –∑–∞–ø–∏—Å–∏ –¥–ª—è DNS:
```
Please deploy a DNS TXT record:
_acme-challenge.e-novolunie.ru
–ó–Ω–∞—á–µ–Ω–∏–µ: 00XvlVkxaIwO-aCcozQWZKvu54777yN1QGY9x7LZERg
```

#### –î–æ–±–∞–≤—å—Ç–µ TXT –∑–∞–ø–∏—Å–∏ –≤ DNS:
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://timeweb.cloud
2. **–î–æ–º–µ–Ω—ã** ‚Üí **e-novolunie.ru** ‚Üí **DNS**
3. –î–æ–±–∞–≤—å—Ç–µ TXT –∑–∞–ø–∏—Å—å —Å –∏–º–µ–Ω–µ–º `_acme-challenge` –∏ –∑–Ω–∞—á–µ–Ω–∏–µ–º –∏–∑ certbot
4. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 2-5 –º–∏–Ω—É—Ç
5. –ù–∞–∂–º–∏—Ç–µ **Enter** –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

#### –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤:
```
/etc/letsencrypt/live/e-novolunie.ru/
‚îú‚îÄ‚îÄ fullchain.pem  ‚Üê –ø–æ–ª–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Nginx)
‚îú‚îÄ‚îÄ privkey.pem    ‚Üê –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
‚îú‚îÄ‚îÄ chain.pem      ‚Üê –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
‚îî‚îÄ‚îÄ cert.pem       ‚Üê —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
```

---

## üìã –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø–æ–ª—É—á–µ–Ω–∏—è

### HTTP Challenge (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ HTTP)
```bash
sudo certbot certonly --standalone \
  -d e-novolunie.ru -d www.e-novolunie.ru \
  --register-unsafely-without-email --agree-tos
```

**‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:** –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –ø–æ—Ä—Ç 80 –±—ã–ª —Å–≤–æ–±–æ–¥–µ–Ω –∏ –¥–æ–º–µ–Ω —É–∫–∞–∑—ã–≤–∞–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

### Webroot Challenge (–µ—Å–ª–∏ —Å–∞–π—Ç —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
```bash
sudo certbot certonly --webroot \
  -w /var/www/html \
  -d e-novolunie.ru -d www.e-novolunie.ru \
  --register-unsafely-without-email --agree-tos
```

---

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

Let's Encrypt —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã 90 –¥–Ω–µ–π. Certbot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏—Ö.

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
```bash
sudo certbot renew --dry-run
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
```bash
sudo crontab -e
# –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:
0 0 1 * * certbot renew --quiet && systemctl reload nginx
```

---

## üåê –î—Ä—É–≥–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö SSL

### 1. Let's Encrypt (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- ‚úÖ –ü—Ä–∏–∑–Ω–∞–µ—Ç—Å—è –≤—Å–µ–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏
- üåê https://letsencrypt.org

### 2. ZeroSSL
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π
- ‚úÖ –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 90 –¥–Ω–µ–π
- üåê https://zerossl.com

### 3. Cloudflare (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∏—Ö DNS)
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π
- üåê https://cloudflare.com

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Let's Encrypt —á–µ—Ä–µ–∑ certbot** - —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ –∏ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±.

**–ù–∞—á–Ω–∏—Ç–µ —Å:**
```bash
cd ~/novolunie
sudo ./install-ssl-dns.sh
```

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- Let's Encrypt: https://letsencrypt.org
- Certbot –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://eff-certbot.readthedocs.io/
- Timeweb Cloud SSL: https://timeweb.cloud/docs/ssl/installing-ssl
