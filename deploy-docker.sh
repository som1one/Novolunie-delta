#!/bin/bash

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ (–∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–∏)
SERVER="user@your-server-ip"
REMOTE_PATH="~/novolunie"

echo "üöÄ –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Docker..."

# –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
echo "üì§ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä..."
rsync -avz --exclude '.git' --exclude 'node_modules' --exclude '*.md' --exclude 'deploy*.sh' \
  ./ $SERVER:$REMOTE_PATH/

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
echo "üî® –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞..."
ssh $SERVER "cd $REMOTE_PATH && docker compose up -d --build"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
echo "üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞..."
ssh $SERVER "cd $REMOTE_PATH && docker compose ps"

echo "‚úÖ –ì–æ—Ç–æ–≤–æ! –°–∞–π—Ç –æ–±–Ω–æ–≤–ª–µ–Ω."
